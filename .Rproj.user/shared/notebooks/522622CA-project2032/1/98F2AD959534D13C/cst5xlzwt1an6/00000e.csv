"0","# Total Events (medal winning opportunities)"
"0","d <- results_p1 %>% "
"0","  mutate(Year = ifelse(Year%in%c(2021),as.numeric(2020),Year)) %>%"
"0","  filter(Nationality %in% c('AUS','GBR','USA','CHN','JPN','RUS','ROC')) %>%"
"0","  group_by(Nationality, Year) %>%"
"0","  summarise(MWO = n_distinct(Sport,Discipline,Gender), .groups='drop')"
"0",""
"0","# nswis <- results_p1 %>% filter(nswisResult==1) %>%"
"0","#   mutate(Year = ifelse(Year%in%c(2021),2020,Year)) %>%"
"0","#   group_by(Year) %>%"
"0","#   summarise(MWO = n_distinct(Sport,Discipline,Gender),.groups='drop') %>%"
"0","#   mutate(Nationality = 'NSWIS')"
"0","# "
"0","# d <- rbind(d,nswis) %>%"
"0","#   mutate(highlight = ifelse(Nationality=='NSWIS','yes','no'))"
"0",""
"0","aus <- mean(d$MWO[which(d$Year!=2000 & d$Nationality=='AUS')])"
"0","usa <- mean(d$MWO[which(d$Year!=1996 & d$Nationality=='USA')])"
"0","gbr <- mean(d$MWO[which(d$Year!=2012 & d$Nationality=='GBR')])"
"0","nsw <- mean(d$MWO[which(d$Year!=2000 & d$Nationality=='NSWIS')])"
"0","jpn <- mean(d$MWO[which(d$Year!=2020 & d$Nationality=='JPN')])"
"0",""
"0","d2 <- d %>%"
"0","  mutate("
"0","    Adjusted = ifelse(Year==2000 & Nationality=='AUS', aus, ifelse("
"0","      Year==1996 & Nationality=='USA', usa, ifelse("
"0","        Year==2012 & Nationality=='GBR', gbr, ifelse("
"0","          Year==2000 & Nationality=='NSWIS', nsw, MWO)))))"
"0",""
"0","d <- cbind(d, d2[,""Adjusted""]) %>%"
"0","  rename(Actual=MWO) %>%"
"0","  gather(key='MWO',value='y',-c(Nationality,Year)) %>% filter(MWO=='Adjusted')"
"0",""
"0","d %>%"
"0","  ggplot(aes(x=Year, y=y, group=Nationality)) +"
"0","  geom_point(aes(shape=Nationality)) +"
"0","  geom_line(aes(linetype=Nationality)) +"
"0","  geom_text(data=d%>%filter(Year==max(d$Year,na.rm=TRUE)),"
"0","            aes(x=Year,y=y,label=Nationality),"
"0","            hjust=-0.3,size=3) +"
"0","  # facet_wrap(.~MWO) +"
"0","  labs(title = 'Total Medal Winning Opportunities', x='', y='') +"
"0","  theme_classic() +"
"0","  theme(legend.position='none') +"
"0","  scale_colour_manual(values=c('yes'='steelblue4','no'='grey40'),guide=FALSE) +"
"0","  scale_y_continuous(expand = c(0,0), limits = c(120,1.05*max(d$y))) + "
"0","  scale_x_continuous(breaks = c(1996,2000,2004,2008,2012,2016,2020), limits = c(1996,2024))"
