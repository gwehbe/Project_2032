"0","# total medals"
"0","tot_medals <- results_p1 %>% filter(Rank %in% c(1,2,3)) %>%"
"0","  group_by(Nationality) %>%"
"0","  summarise(Medals = n_distinct(phase_result_id)) %>%"
"0","  arrange(desc(Medals)) "
"2","There were 18 warnings (use warnings() to see them)"
"2","
"
"0","# total athletes"
"0","tot_athletes <- results_p1 %>% "
"0","  group_by(Nationality, Year) %>%"
"0","  summarise(Athletes = n_distinct(athleteID), .groups='drop') %>%"
"0","  group_by(Nationality) %>%"
"0","  summarise(`Total Athletes` = sum(Athletes), .groups='drop')"
"0",""
"0","d <- tot_medals %>% left_join(tot_athletes, by=c(""Nationality""))"
"0",""
"0","nswis_medals <- results_p1 %>% filter(nswisResult==1 & Rank %in% c(1,2,3)) %>%"
"0","  summarise(Medals = n_distinct(phase_result_id)) %>%"
"0","  arrange(desc(Medals)) "
"0",""
"0","nswis_athletes <- results_p1 %>%  filter(nswisResult==1) %>%"
"0","  group_by(Year) %>%"
"0","  summarise(Athletes = n_distinct(athleteID), .groups='drop') %>%"
"0","  summarise(`Total Athletes` = sum(Athletes))"
"0",""
"0","nswis <- cbind(nswis_athletes,nswis_medals)"
"0",""
"0","d %>%"
"0","  ggplot(aes(x=`Total Athletes`, y=Medals)) +"
"0","  geom_point(colour='grey40') +"
"0","  geom_point(data=nswis,aes(x=`Total Athletes`,y=Medals),colour='blue') +"
"0","  geom_smooth(formula = y~x, method = 'lm', se=FALSE, colour='black', linetype='dashed', size=0.5) +"
"0","  geom_text(data = d %>% filter(Nationality %in% c('AUS','CHN','GBR','USA','NZL','RUS','GER')), "
"0","            aes(label=Nationality), vjust=1.5,size=3) +"
"0","    geom_text(data = nswis, aes(label='NSWIS'), vjust=-1,size=3,colour='blue') +"
"0","  labs(title = 'Total Olympic Medals versus Total Athletes by Nation since 1996') +"
"0","  theme_classic() "
