"0",""
"0","d <- results_p1 %>% "
"0","  mutate(Year = ifelse(Year%in%c(2021),2020,Year)) %>%"
"0","  filter(Nationality %in% c('AUS','GBR','USA','CHN','BRA','GRE','JPN')) %>%"
"0","  group_by(Nationality, Year) %>%"
"0","    summarise("
"0","    Conversion = 100* n_distinct(ifelse(Rank %in% c(1,2,3),phase_result_id,NA),na.rm=TRUE)/("
"0","      n_distinct(Sport,Discipline,Gender)),.groups='drop') %>%"
"0","  mutate("
"0","    Status = ifelse("
"0","      Year==2000 & Nationality=='AUS', 'Home Games', ifelse("
"0","        Year==1996 & Nationality=='USA', 'Home Games', ifelse("
"0","          Year==2012 & Nationality=='GBR', 'Home Games', ifelse("
"0","            Year==2004 & Nationality=='GRE', 'Home Games', ifelse("
"0","              Year==2008 & Nationality=='CHN', 'Home Games', ifelse("
"0","                Year==2016 & Nationality=='BRA', 'Home Games', ifelse("
"0","                  Year==2020 & Nationality=='JPN', 'Home Games', 'Away Games')))))))) %>%"
"0","  group_by(Nationality, Status) %>%"
"0","  summarise(y = mean(Conversion, na.rm=TRUE), .groups='drop')"
"2","There were 25 warnings (use warnings() to see them)"
"2","
"
"0","nswis <- results_p1 %>% filter(nswisResult==1) %>%"
"0","  mutate(Year = ifelse(Year%in%c(2021),2020,Year)) %>%"
"0","  group_by(Year) %>%"
"0","  summarise("
"0","    Conversion = 100* n_distinct(ifelse(Rank %in% c(1,2,3),phase_result_id,NA),na.rm=TRUE)/("
"0","      n_distinct(Sport,Discipline,Gender)),.groups='drop') %>%"
"0","  mutate(Nationality = 'NSWIS',"
"0","         Status = ifelse(Year==2000, 'Home Games', 'Away Games')) %>%"
"0","  group_by(Nationality, Status) %>%"
"0","  summarise(y = mean(Conversion, na.rm=TRUE), .groups='drop')"
"0",""
"0","d <- rbind(d,nswis) %>%"
"0","  mutate(highlight = ifelse(Nationality=='NSWIS','yes','no'))"
"0",""
"0","d %>%"
"0","  ggplot(aes(x=Status, y=y, group=Nationality,colour=highlight)) +"
"0","  geom_point(aes()) +"
"0","  geom_line(aes(linetype=Nationality)) +"
"0","  geom_text(data=d%>%filter(Status=='Away Games' & Nationality!='NSWIS'),"
"0","            aes(x=Status,y=y,label=Nationality),"
"0","            hjust=1.5,size=3) +"
"0","    geom_text(data=d%>%filter(Status=='Home Games' & Nationality=='NSWIS'),"
"0","            aes(x=Status,y=y,label=Nationality),"
"0","            hjust=-0.5,size=3) +"
"0","  labs(title = ""Avg. Conversion Rate (%) since '96"", x='', y='') +"
"0","  theme_classic() +"
"0","  theme(legend.position='none') +"
"0","  scale_colour_manual(values=c('yes'='steelblue4','no'='grey40'),guide=FALSE) +"
"0","  scale_y_continuous(expand = c(0,0), limits = c(0,1.05*max(d$y))) "
