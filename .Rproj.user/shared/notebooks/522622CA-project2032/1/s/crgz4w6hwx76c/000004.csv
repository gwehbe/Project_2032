"0","# Total Medals Tally"
"0","d <- results_p1 %>% filter(Rank %in% c(1,2,3)) %>%"
"0","  group_by(Nationality) %>%"
"0","  summarise(Medals = n_distinct(phase_result_id)) %>%"
"0","  arrange(desc(Medals)) %>%"
"0","  top_n(Medals, n = 20)"
"0",""
"0","nswis <- results_p1 %>% filter(nswisResult==1 & Rank %in% c(1,2,3)) %>%"
"0","  summarise(Medals = n_distinct(phase_result_id)) %>%"
"0","  mutate(Nationality = 'NSWIS')"
"0",""
"0","d <- rbind(d,nswis) %>%"
"0","  mutate(highlight = ifelse(Nationality=='NSWIS','yes','no'))"
"0",""
"0","d %>%"
"0","  ggplot(aes(x=reorder(Nationality, Medals), y=Medals, fill=highlight)) +"
"0","  geom_bar(stat = ""identity"", width = 0.65) +"
"0","  geom_text(aes(label=Medals), hjust=-0.1, size=4) +"
"0","  coord_flip() +"
"0","  labs(title = 'Total Olympic Medals since 1996 (Top 20 Nations)', x='', y='') +"
"0","  theme_classic() +"
"0","  scale_fill_manual(values=c('yes'='steelblue4','no'='grey60'),guide=FALSE) +"
"0","  scale_y_continuous(expand = c(0,0), limits = c(0,1.2*max(d$Medals)))"
