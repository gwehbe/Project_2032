"0","# Total Olympic Squad sizes (sum of athlete numbers each Games)"
"0","d <- results_p1 %>% "
"0","  group_by(Nationality, Year) %>%"
"0","  summarise(Athletes = n_distinct(athleteID), .groups='drop') %>%"
"0","  group_by(Nationality) %>%"
"0","  summarise(Athletes = sum(Athletes), .groups='drop') %>%"
"0","  arrange(desc(Athletes)) %>%"
"0","  top_n(Athletes, n = 20)"
"2","There were 25 warnings (use warnings() to see them)"
"2","
"
"0","nswis <- results_p1 %>% filter(nswisResult==1) %>%"
"0","  group_by(Year) %>%"
"0","  summarise(Athletes = n_distinct(athleteID),.groups='drop') %>%"
"0","  summarise(Athletes = sum(Athletes)) %>%"
"0","  mutate(Nationality = 'NSWIS')"
"0",""
"0","d <- rbind(d,nswis) %>%"
"0","  mutate(highlight = ifelse(Nationality=='NSWIS','yes','no'))"
"0",""
"0","d %>%"
"0","  ggplot(aes(x=reorder(Nationality, Athletes),fill=highlight, y=Athletes)) +"
"0","  geom_bar(stat = ""identity"", width = 0.65) +"
"0","  geom_text(aes(label=Athletes), hjust=-0.1, size=4) +"
"0","  coord_flip() +"
"0","  labs(title = 'Cumulative Olympic Squad Size since 1996 (Top 20 Nations)', x='', y='') +"
"0","  theme_classic() +"
"0","  scale_fill_manual(values=c('yes'='steelblue4','no'='grey60'),guide=FALSE) +"
"0","  scale_y_continuous(expand = c(0,0), limits = c(0,1.2*max(d$Athletes)))"
