"0","d <- results_p1 %>%"
"0","filter(Sport %in% c('Swimming',"
"0","                      'Athletics',"
"0","                      'Cycling - Track',"
"0","                      'Rowing',"
"0","                      'Sailing',"
"0","                      'Canoe - Sprint',"
"0","                      'Shooting',#,"
"0","                      # 'Diving',"
"0","                      'Judo',"
"0","                      'Gymnastics - Artistic'"
"0","                      ) #&"
"0","           # Nationality %in% c('AUS')"
"0","           ) %>%"
"0","  mutate(ageBin = cut(Age, "
"0","                      breaks = c(0,14,18,22,26,30,34,38,42,Inf),"
"0","                      labels = c('<15','15-18','19-22','23-26','27-30','31-34',"
"0","                                 '35-38','39-42','>42'))) %>%"
"0","  group_by(Sport, ageBin, Year) %>%"
"0","  summarise(meds=n_distinct(ifelse(Rank %in% c(1,2,3), athleteID, NA), na.rm = TRUE), .groups='drop') %>%"
"0","  group_by(Sport, Year) %>%"
"0","  mutate(`Medalists`= 100*meds/sum(meds,na.rm=TRUE)) %>%"
"0","  group_by(Sport, ageBin) %>%"
"0","  summarise(y=mean(`Medalists`,na.rm=TRUE), .groups='drop') %>%"
"0","  filter(y>0.5)"
"2","There were 50 or more warnings (use warnings() to see the first 50)"
"2","
"
"0","d %>%"
"0","  ggplot(aes(x=ageBin, y=y"
"0","             )) +"
"0","  geom_bar(stat='identity',fill='grey60',width=0.65) +"
"0","  geom_text(aes(label=paste0(round(y,0),'%')),"
"0","            vjust=-0.5,size=3) +"
"0","  facet_wrap(.~Sport) +"
"0","  labs(title = ""Medalists breakdown by Age and Sport"", x='Age (years)', y='') +"
"0","  theme_classic() +"
"0","  theme(axis.text.y = element_blank(),"
"0","        axis.text.x = element_text(angle=45, hjust=1,size=8),"
"0","        axis.ticks.y = element_blank()) +"
"0","  scale_y_continuous(expand = c(0,0), limits = c(0,1.2*max(d$y))) "
