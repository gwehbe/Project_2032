"0","# Total Events (medal winning opportunities)"
"0","d <- results_p1 %>% "
"0","  mutate(Year = ifelse(Year%in%c(2021),2020,Year)) %>%"
"0","  filter(Nationality %in% c('AUS','GBR','NZL','USA')) %>%"
"0","  group_by(Nationality, Year, phase_result_id) %>%"
"0","  mutate(teamSize = n_distinct(athleteID)) %>%"
"0","  mutate(teamSize = factor(ifelse("
"0","    teamSize==1,'individual events',ifelse("
"0","      teamSize>=2 & teamSize<=4,'2-4 person events',ifelse("
"0","          teamSize>4,'5+ person events',NA))), levels=c('individual events',"
"0","                                                         '2-4 person events',"
"0","                                                         '5+ person events'))) %>%"
"0","  group_by(Nationality, Year, teamSize) %>%"
"0","  summarise(MWO = n_distinct(Sport,Discipline,Gender), .groups='drop')"
"2","There were 50 or more warnings (use warnings() to see the first 50)"
"2","
"
"0","d %>%"
"0","  ggplot(aes(x=Year, y=MWO, group=teamSize)) +"
"0","  geom_point(aes(shape=teamSize),colour='grey40') +"
"0","  geom_line(aes(linetype=teamSize),colour='grey40') +"
"0","  facet_wrap(.~Nationality, ncol=4) +"
"0","  labs(title = 'Total Medal Winning Opportunities', x='', y='',linetype='',shape='') +"
"0","  theme_classic() +"
"0","  theme(legend.position='top',"
"0","        axis.text.x = element_text(angle=45, hjust=1,size=8)) +"
"0","  scale_y_continuous(expand = c(0,0), limits = c(0,1.1*max(d$MWO))) + "
"0","  scale_x_continuous(breaks = c(1996,2000,2004,2008,2012,2016,2020),limits = c(1995,2022))"
